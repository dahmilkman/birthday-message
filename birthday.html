<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday My Love</title>
  <style>
    :root{
      --card-bg: rgba(255,255,255,0.88);
      --accent: #ff6699;
    }
    html,body{
      height:100%;
      margin:0;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg,#ffe6f0,#fff 60%);
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      font-size: 1.2rem;
      color: #222;
      overflow: hidden; /* keep falling items inside viewport */
      padding: 2rem;
    }

    /* Message card */
    #message {
      position: relative;
      z-index: 20;
      border-right: 2px solid var(--accent);
      white-space: pre-wrap;
      overflow: hidden;
      max-width: 680px;
      line-height: 1.6;
      background: var(--card-bg);
      padding: 26px;
      border-radius: 18px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.12);
      text-align: center;
      font-size: 1.15rem;
    }

    /* Falling emoji elements */
    .falling {
      position: fixed;
      top: -12vh;              /* start slightly above viewport */
      pointer-events: none;
      transform-origin: center;
      will-change: transform, opacity;
      z-index: 10;
      user-select: none;
      opacity: 0.95;
    }

    @keyframes fall {
      from {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      to {
        transform: translateY(120vh) rotate(360deg);
        opacity: 0.35;
      }
    }

    /* Respect reduced-motion preference */
    @media (prefers-reduced-motion: reduce) {
      .falling { animation: none !important; display: none !important; }
    }
  </style>
</head>
<body>
  <div id="message" aria-live="polite"></div>

  <script>
    // --- Typewriter text ---
    const text = `Happy Birthday my love 💖

Every day with you feels like a gift, but today is extra special because it's the day the world got you.

Thank you for filling my life with laughter, warmth, and love. I can’t wait to celebrate many more birthdays with you.

You are my favorite person in the whole universe 🌙✨`;
    const speed = 55; // ms per character
    const msgEl = document.getElementById('message');

    let i = 0;
    function typeWriter() {
      if (i <= text.length) {
        // Use textContent to avoid accidental HTML parsing and keep emoji safe
        msgEl.textContent = text.slice(0, i);
        i++;
        setTimeout(typeWriter, speed);
      } else {
        msgEl.style.borderRight = 'none';
      }
    }

    // --- Falling stars & flowers ---
    const emojis = ["🌸","🌹","🌺","🌼","✨","⭐","💫","🍃"];
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function spawnEmoji() {
      if (prefersReduced) return; // skip animation if user prefers reduced motion

      const el = document.createElement('div');
      el.className = 'falling';
      el.textContent = emojis[Math.floor(Math.random() * emojis.length)];

      // random horizontal starting position (leave small margin)
      const margin = 20;
      const left = Math.floor(Math.random() * (window.innerWidth - margin*2)) + margin;
      el.style.left = left + 'px';

      // random size
      const size = Math.floor(16 + Math.random() * 44); // 16px to 60px
      el.style.fontSize = size + 'px';

      // random animation duration
      const dur = (4 + Math.random() * 6).toFixed(2); // 4s - 10s
      el.style.animation = `fall ${dur}s linear forwards`;

      // slight initial rotation
      const rot = Math.floor(Math.random() * 360);
      el.style.transform = `rotate(${rot}deg)`;

      document.body.appendChild(el);

      // remove element when animation ends
      el.addEventListener('animationend', () => {
        if (el && el.parentNode) el.parentNode.removeChild(el);
      });

      // safety remove if something goes wrong after 12s
      setTimeout(()=> { if (el.parentNode) el.parentNode.removeChild(el); }, (parseFloat(dur)+1)*1000);
    }

    // spawn periodically while typing and a short while after
    let spawnInterval;
    function startSpawning() {
      spawnInterval = setInterval(spawnEmoji, 420);
      // stop spawning after 18s (page will still show existing falling elements)
      setTimeout(()=> clearInterval(spawnInterval), 18000);
    }

    // start everything on load
    window.addEventListener('load', () => {
      typeWriter();
      startSpawning();
    });

    // Optional: if user navigates/resizes, ensure future emojis land within viewport
    window.addEventListener('resize', () => {/* nothing needed; spawn reads window size each time */});
  </script>
</body>
</html>
